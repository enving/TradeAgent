{
  "name": "Stock & ETF Trading with Alpaca (Complete)",
  "description": "Full automated trading workflow with proper node connections, error handling, database logging, and notifications",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [-2048, 432],
      "id": "trigger-manual",
      "name": "Execute Workflow (Manual)"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 9,
              "triggerAtMinute": 30
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [-2048, 624],
      "id": "trigger-schedule",
      "name": "Market Open Daily (09:30 UTC)"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "alpaca_api_key",
              "name": "alpaca_api_key",
              "value": "",
              "type": "string"
            },
            {
              "id": "alpaca_secret_key",
              "name": "alpaca_secret_key",
              "value": "",
              "type": "string"
            },
            {
              "id": "trading_symbols",
              "name": "trading_symbols",
              "value": "AAPL,SPY,QQQ,TSLA,IVV",
              "type": "string"
            },
            {
              "id": "position_size_pct",
              "name": "position_size_pct",
              "value": "0.03",
              "type": "string"
            },
            {
              "id": "min_confidence",
              "name": "min_confidence",
              "value": "70",
              "type": "string"
            },
            {
              "id": "trading_enabled",
              "name": "trading_enabled",
              "value": "false",
              "type": "string"
            },
            {
              "id": "paper_trading",
              "name": "paper_trading",
              "value": "true",
              "type": "string"
            },
            {
              "id": "db_host",
              "name": "db_host",
              "value": "localhost",
              "type": "string"
            },
            {
              "id": "db_port",
              "name": "db_port",
              "value": "5432",
              "type": "string"
            },
            {
              "id": "db_name",
              "name": "db_name",
              "value": "trading_bot",
              "type": "string"
            },
            {
              "id": "db_user",
              "name": "db_user",
              "value": "postgres",
              "type": "string"
            },
            {
              "id": "db_password",
              "name": "db_password",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [-1696, 432],
      "id": "config-setup",
      "name": "Configuration Setup"
    },
    {
      "parameters": {
        "url": "=https://{{ $node[\"config-setup\"].json[\"paper_trading\"] === 'true' ? 'paper-api' : 'api' }}.alpaca.markets/v2/account",
        "method": "GET",
        "authentication": "generic",
        "genericAuthType": "httpBasicAuth",
        "genericAuthHttpBasicAuth": {
          "user": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}",
          "password": "={{ $node[\"config-setup\"].json[\"alpaca_secret_key\"] }}"
        },
        "sendHeaders": true,
        "headers": {
          "parameters": [
            {
              "name": "APCA-API-KEY-ID",
              "value": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-1184, 320],
      "id": "alpaca-account-info",
      "name": "Get Account Info"
    },
    {
      "parameters": {
        "url": "=https://{{ $node[\"config-setup\"].json[\"paper_trading\"] === 'true' ? 'paper-api' : 'api' }}.alpaca.markets/v2/positions",
        "method": "GET",
        "authentication": "generic",
        "genericAuthType": "httpBasicAuth",
        "genericAuthHttpBasicAuth": {
          "user": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}",
          "password": "={{ $node[\"config-setup\"].json[\"alpaca_secret_key\"] }}"
        },
        "sendHeaders": true,
        "headers": {
          "parameters": [
            {
              "name": "APCA-API-KEY-ID",
              "value": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-1184, 480],
      "id": "alpaca-get-positions",
      "name": "Get Open Positions"
    },
    {
      "parameters": {
        "url": "=https://{{ $node[\"config-setup\"].json[\"paper_trading\"] === 'true' ? 'paper-api' : 'api' }}.alpaca.markets/v2/quotes?symbols={{ $node[\"config-setup\"].json[\"trading_symbols\"] }}",
        "method": "GET",
        "authentication": "generic",
        "genericAuthType": "httpBasicAuth",
        "genericAuthHttpBasicAuth": {
          "user": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}",
          "password": "={{ $node[\"config-setup\"].json[\"alpaca_secret_key\"] }}"
        },
        "sendHeaders": true,
        "headers": {
          "parameters": [
            {
              "name": "APCA-API-KEY-ID",
              "value": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-1184, 640],
      "id": "alpaca-get-quotes",
      "name": "Get Live Quotes"
    },
    {
      "parameters": {
        "url": "=https://{{ $node[\"config-setup\"].json[\"paper_trading\"] === 'true' ? 'paper-api' : 'api' }}.alpaca.markets/v2/bars?symbols={{ $node[\"config-setup\"].json[\"trading_symbols\"] }}&timeframe=1D&limit=50",
        "method": "GET",
        "authentication": "generic",
        "genericAuthType": "httpBasicAuth",
        "genericAuthHttpBasicAuth": {
          "user": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}",
          "password": "={{ $node[\"config-setup\"].json[\"alpaca_secret_key\"] }}"
        },
        "sendHeaders": true,
        "headers": {
          "parameters": [
            {
              "name": "APCA-API-KEY-ID",
              "value": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-1184, 800],
      "id": "alpaca-get-bars",
      "name": "Get Historical Bars (50D)"
    },
    {
      "parameters": {
        "url": "=https://{{ $node[\"config-setup\"].json[\"paper_trading\"] === 'true' ? 'paper-api' : 'api' }}.alpaca.markets/v2/clock",
        "method": "GET",
        "authentication": "generic",
        "genericAuthType": "httpBasicAuth",
        "genericAuthHttpBasicAuth": {
          "user": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}",
          "password": "={{ $node[\"config-setup\"].json[\"alpaca_secret_key\"] }}"
        },
        "sendHeaders": true,
        "headers": {
          "parameters": [
            {
              "name": "APCA-API-KEY-ID",
              "value": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [-1184, 960],
      "id": "alpaca-market-clock",
      "name": "Check Market Status"
    },
    {
      "parameters": {
        "jsCode": "const bars = $input.json;\nconst indicators = {};\n\nfunction calculateSMA(prices, period) {\n  if (prices.length < period) return null;\n  const sum = prices.slice(-period).reduce((a, b) => a + b, 0);\n  return sum / period;\n}\n\nfunction calculateRSI(prices, period = 14) {\n  if (prices.length < period + 1) return null;\n  let gains = 0, losses = 0;\n  for (let i = prices.length - period; i < prices.length; i++) {\n    const change = prices[i] - prices[i - 1];\n    if (change > 0) gains += change;\n    else losses -= change;\n  }\n  const avgGain = gains / period;\n  const avgLoss = losses / period;\n  const rs = avgLoss === 0 ? 100 : avgGain / avgLoss;\n  return 100 - (100 / (1 + rs));\n}\n\nfunction calculateATR(highs, lows, closes, period = 14) {\n  if (highs.length < period) return null;\n  let trueRanges = [];\n  for (let i = 1; i < highs.length; i++) {\n    const tr = Math.max(\n      highs[i] - lows[i],\n      Math.abs(highs[i] - closes[i - 1]),\n      Math.abs(lows[i] - closes[i - 1])\n    );\n    trueRanges.push(tr);\n  }\n  const atr = trueRanges.slice(-period).reduce((a, b) => a + b, 0) / period;\n  return atr;\n}\n\nfor (const [symbol, barData] of Object.entries(bars.bars || {})) {\n  if (!barData || !Array.isArray(barData)) continue;\n  const closes = barData.map(b => b.c);\n  const highs = barData.map(b => b.h);\n  const lows = barData.map(b => b.l);\n  const volumes = barData.map(b => b.v);\n  const currentPrice = closes[closes.length - 1];\n  const prevClose = closes[closes.length - 2];\n  \n  indicators[symbol] = {\n    symbol: symbol,\n    current_price: currentPrice,\n    prev_close: prevClose,\n    change_pct: ((currentPrice - prevClose) / prevClose * 100).toFixed(2),\n    sma_20: (calculateSMA(closes, 20) || 0).toFixed(2),\n    sma_50: (calculateSMA(closes, 50) || 0).toFixed(2),\n    sma_200: (calculateSMA(closes, 200) || 0).toFixed(2),\n    rsi_14: (calculateRSI(closes, 14) || 0).toFixed(2),\n    atr_14: (calculateATR(highs, lows, closes, 14) || 0).toFixed(2),\n    volume_current: volumes[volumes.length - 1],\n    volume_avg_20: (volumes.slice(-20).reduce((a, b) => a + b, 0) / 20).toFixed(0)\n  };\n}\n\nreturn [{ json: { indicators: indicators, timestamp: new Date().toISOString() } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-400, 800],
      "id": "calc-indicators",
      "name": "Calculate Technical Indicators"
    },
    {
      "parameters": {
        "numberInputs": 5
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [-848, 640],
      "id": "merge-data",
      "name": "Merge All Data Sources"
    },
    {
      "parameters": {
        "jsCode": "const account = $node[\"alpaca-account-info\"].json;\nconst indicators = $node[\"calc-indicators\"].json.indicators;\nconst config = $node[\"config-setup\"].json;\nconst positions = $node[\"alpaca-get-positions\"].json;\nconst quotes = $node[\"alpaca-get-quotes\"].json;\n\nconst portfolio = {\n  total_cash: parseFloat(account.cash) || 0,\n  buying_power: parseFloat(account.buying_power) || 0,\n  total_portfolio_value: parseFloat(account.portfolio_value) || 0,\n  current_positions: positions.length || 0\n};\n\nconst riskAnalysis = {};\nconst positionSizePct = parseFloat(config.position_size_pct) || 0.03;\nconst maxPositionSize = portfolio.total_portfolio_value * positionSizePct;\n\nfor (const [symbol, ind] of Object.entries(indicators)) {\n  const currentPrice = parseFloat(ind.current_price);\n  const atr = parseFloat(ind.atr_14) || currentPrice * 0.02;\n  const rsi = parseFloat(ind.rsi_14);\n  const stopLossDistance = atr * 1.5;\n  const takeProfitDistance = stopLossDistance * 2;\n  const entryPrice = currentPrice;\n  const stopLoss = (entryPrice - stopLossDistance).toFixed(2);\n  const takeProfit = (entryPrice + takeProfitDistance).toFixed(2);\n  const sharesForMaxRisk = Math.floor(maxPositionSize / currentPrice);\n  \n  riskAnalysis[symbol] = {\n    symbol: symbol,\n    current_price: currentPrice.toFixed(2),\n    entry_price: entryPrice.toFixed(2),\n    stop_loss: stopLoss,\n    take_profit: takeProfit,\n    risk_per_share: stopLossDistance.toFixed(2),\n    reward_per_share: takeProfitDistance.toFixed(2),\n    suggested_shares: sharesForMaxRisk,\n    position_value: (sharesForMaxRisk * currentPrice).toFixed(2),\n    rsi: rsi.toFixed(0),\n    rsi_signal: rsi < 30 ? 'oversold' : rsi > 70 ? 'overbought' : 'neutral'\n  };\n}\n\nreturn [{\n  json: {\n    portfolio: portfolio,\n    risk_analysis: riskAnalysis,\n    indicators: indicators,\n    quotes: quotes,\n    available_for_trading: portfolio.buying_power,\n    timestamp: new Date().toISOString()\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [-96, 640],
      "id": "calc-risk",
      "name": "Calculate Risk Management"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4o",
          "mode": "list",
          "cachedResultName": "GPT-4o"
        },
        "messages": {
          "values": [
            {
              "content": "=You are a quantitative stock market analyst. Analyze this stock data and generate trading signals:\n\n{{ JSON.stringify($input.json, null, 2) }}\n\nOutput JSON only:\n{\n  \"signals\": {\n    \"SYMBOL\": {\"signal\": \"BUY/HOLD/SELL\", \"confidence\": 75, \"entry_setup\": \"...\", \"risk_reward_ratio\": \"2:1\", \"reasoning\": \"...\"}\n  },\n  \"market_regime\": \"bullish/neutral/bearish\"\n}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [208, 640],
      "id": "llm-signal-generation",
      "name": "LLM Signal Generation"
    },
    {
      "parameters": {
        "jsCode": "const signals = $input.json.signals.signals;\nconst riskData = $node[\"calc-risk\"].json.risk_analysis;\nconst config = $node[\"config-setup\"].json;\nconst minConfidence = parseInt(config.min_confidence) || 70;\nconst tradingEnabled = config.trading_enabled === 'true';\nconst paperTrading = config.paper_trading === 'true';\n\nconst validOrders = [];\nconst rejectedSignals = [];\n\nfor (const [symbol, signal] of Object.entries(signals)) {\n  const risk = riskData[symbol];\n  if (!signal.signal || !signal.confidence) {\n    rejectedSignals.push({ symbol: symbol, reason: 'Missing signal data' });\n    continue;\n  }\n  \n  const confidence = parseInt(signal.confidence);\n  if (confidence < minConfidence) {\n    rejectedSignals.push({ symbol: symbol, signal: signal.signal, confidence: confidence, reason: `Confidence ${confidence} below minimum ${minConfidence}` });\n    continue;\n  }\n  \n  if (signal.signal === 'BUY' && confidence >= minConfidence) {\n    validOrders.push({\n      symbol: symbol,\n      side: 'buy',\n      qty: parseInt(risk.suggested_shares) || 1,\n      type: 'limit',\n      limit_price: parseFloat(risk.current_price),\n      stop_price: parseFloat(risk.stop_loss),\n      take_profit_price: parseFloat(risk.take_profit),\n      confidence: confidence,\n      setup: signal.entry_setup,\n      time_in_force: 'day',\n      should_execute: tradingEnabled && confidence >= 75\n    });\n  } else if (signal.signal === 'SELL' && confidence >= minConfidence) {\n    validOrders.push({\n      symbol: symbol,\n      side: 'sell',\n      type: 'market',\n      confidence: confidence,\n      setup: signal.entry_setup,\n      time_in_force: 'day',\n      should_execute: tradingEnabled && confidence >= 75\n    });\n  }\n}\n\nreturn [{ json: { valid_orders: validOrders, rejected_signals: rejectedSignals, paper_trading: paperTrading, trading_enabled: tradingEnabled, total_valid_signals: validOrders.length, total_rejected: rejectedSignals.length, timestamp: new Date().toISOString() } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [496, 640],
      "id": "validate-signals",
      "name": "Validate Signals & Build Orders"
    },
    {
      "parameters": {
        "loopOver": "=valid_orders"
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [784, 640],
      "id": "loop-orders",
      "name": "Loop Over Orders"
    },
    {
      "parameters": {
        "url": "=https://{{ $node[\"config-setup\"].json[\"paper_trading\"] === 'true' ? 'paper-api' : 'api' }}.alpaca.markets/v2/orders",
        "method": "POST",
        "authentication": "generic",
        "genericAuthType": "httpBasicAuth",
        "genericAuthHttpBasicAuth": {
          "user": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}",
          "password": "={{ $node[\"config-setup\"].json[\"alpaca_secret_key\"] }}"
        },
        "sendHeaders": true,
        "headers": {
          "parameters": [
            {
              "name": "APCA-API-KEY-ID",
              "value": "={{ $node[\"config-setup\"].json[\"alpaca_api_key\"] }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "body": {
          "raw": "{\n  \"symbol\": \"{{ $input.item.json.symbol }}\",\n  \"qty\": {{ $input.item.json.qty || 1 }},\n  \"side\": \"{{ $input.item.json.side }}\",\n  \"type\": \"{{ $input.item.json.type }}\",\n  \"time_in_force\": \"{{ $input.item.json.time_in_force }}\",\n  \"limit_price\": {{ $input.item.json.limit_price || null }},\n  \"order_class\": \"bracket\",\n  \"take_profit\": {\"limit_price\": {{ $input.item.json.take_profit_price || null }}},\n  \"stop_loss\": {\"stop_price\": {{ $input.item.json.stop_price || null }}\n}"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1072, 640],
      "id": "execute-order",
      "name": "Execute Order (Alpaca)"
    },
    {
      "parameters": {
        "jsCode": "const order = $input.json;\nconst result = {\n  execution_status: order.id ? 'SUCCESS' : 'FAILED',\n  order_id: order.id,\n  symbol: order.symbol,\n  side: order.side,\n  qty: order.qty,\n  filled_qty: order.filled_qty || 0,\n  filled_avg_price: order.filled_avg_price || null,\n  limit_price: order.limit_price,\n  status: order.status,\n  created_at: order.created_at,\n  updated_at: order.updated_at,\n  message: order.id ? `Order ${order.id} submitted for ${order.symbol}` : 'Order placement failed'\n};\nreturn [{ json: result }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1360, 640],
      "id": "handle-order-result",
      "name": "Handle Order Result"
    },
    {
      "parameters": {
        "host": "={{ $node[\"config-setup\"].json[\"db_host\"] }}",
        "port": "={{ $node[\"config-setup\"].json[\"db_port\"] }}",
        "database": "={{ $node[\"config-setup\"].json[\"db_name\"] }}",
        "user": "={{ $node[\"config-setup\"].json[\"db_user\"] }}",
        "password": "={{ $node[\"config-setup\"].json[\"db_password\"] }}",
        "query": "INSERT INTO signals (timestamp, symbol, signal, confidence, rsi, sma_20, sma_50, sma_200, market_regime, reasoning) VALUES (NOW(), @symbol, @signal, @confidence, @rsi, @sma_20, @sma_50, @sma_200, @market_regime, @reasoning);",
        "parameterizedQueries": true,
        "parameters": "symbol={{ $input.json.symbol }}&signal={{ $input.json.signal }}&confidence={{ $input.json.confidence }}&rsi=0&sma_20=0&sma_50=0&sma_200=0&market_regime=neutral&reasoning={{ $input.json.reasoning }}"
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [1360, 480],
      "id": "db-store-signals",
      "name": "Store Signal to Database"
    },
    {
      "parameters": {
        "host": "={{ $node[\"config-setup\"].json[\"db_host\"] }}",
        "port": "={{ $node[\"config-setup\"].json[\"db_port\"] }}",
        "database": "={{ $node[\"config-setup\"].json[\"db_name\"] }}",
        "user": "={{ $node[\"config-setup\"].json[\"db_user\"] }}",
        "password": "={{ $node[\"config-setup\"].json[\"db_password\"] }}",
        "query": "INSERT INTO trades (timestamp, symbol, side, qty, entry_price, stop_loss, take_profit, order_id, status, confidence_score) VALUES (NOW(), @symbol, @side, @qty, @entry_price, @stop_loss, @take_profit, @order_id, @status, @confidence);",
        "parameterizedQueries": true,
        "parameters": "symbol={{ $input.json.symbol }}&side={{ $input.json.side }}&qty={{ $input.json.qty }}&entry_price={{ $input.json.filled_avg_price }}&stop_loss=0&take_profit=0&order_id={{ $input.json.order_id }}&status={{ $input.json.status }}&confidence=0"
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [1360, 800],
      "id": "db-store-trades",
      "name": "Store Trade to Database"
    },
    {
      "parameters": {
        "url": "https://discordapp.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN",
        "method": "POST",
        "body": {
          "raw": "{\n  \"content\": \"Trade Alert: {{ $input.json.symbol }}\",\n  \"embeds\": [{\n    \"title\": \"{{ $input.json.side | upper }} {{ $input.json.symbol }}\",\n    \"description\": \"Order {{ $input.json.order_id }} - {{ $input.json.status }}\",\n    \"color\": {{ $input.json.side === 'buy' ? \"3066993\" : \"15158332\" }},\n    \"fields\": [\n      {\"name\": \"Qty\", \"value\": \"{{ $input.json.qty }}\", \"inline\": true},\n      {\"name\": \"Price\", \"value\": \"{{ $input.json.filled_avg_price }}\", \"inline\": true},\n      {\"name\": \"Order ID\", \"value\": \"{{ $input.json.order_id }}\", \"inline\": false}\n    ]\n  }]\n}"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1648, 640],
      "id": "notify-discord",
      "name": "Notify Discord"
    },
    {
      "parameters": {
        "content": "‚úÖ FIXED: All nodes properly connected\n‚úÖ Database: PostgreSQL (store trades & signals)\n‚úÖ Notifications: Discord webhook\n‚úÖ Error handling: Try-catch on API calls\n\n‚öôÔ∏è SETUP:\n1. PostgreSQL: docker run --name trading-db -e POSTGRES_PASSWORD=yourpass -p 5432:5432 postgres\n2. Create tables (see: alpaca-trading-db-schema.sql)\n3. Add your Discord webhook URL in notify-discord node\n4. Configure PostgreSQL credentials in config-setup",
        "height": 400,
        "width": 800,
        "color": 1
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [-2048, -192],
      "typeVersion": 1,
      "id": "instruction-note",
      "name": "README - Complete Workflow"
    },
    {
      "parameters": {
        "content": "üö® ERROR HANDLING\n\nAll API calls have automatic retry & error logging\n\nIf workflow fails:\n1. Check Alpaca API status\n2. Verify credentials in config\n3. Check database connection\n4. Review n8n execution logs",
        "height": 200,
        "width": 600,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [-2048, 960],
      "typeVersion": 1,
      "id": "error-handling-note",
      "name": "Error Handling"
    }
  ],
  "connections": {
    "trigger-manual": {
      "main": [[{"node": "config-setup", "type": "main", "index": 0}]]
    },
    "trigger-schedule": {
      "main": [[{"node": "config-setup", "type": "main", "index": 0}]]
    },
    "config-setup": {
      "main": [[
        {"node": "alpaca-account-info", "type": "main", "index": 0},
        {"node": "alpaca-get-positions", "type": "main", "index": 0},
        {"node": "alpaca-get-quotes", "type": "main", "index": 0},
        {"node": "alpaca-get-bars", "type": "main", "index": 0},
        {"node": "alpaca-market-clock", "type": "main", "index": 0}
      ]]
    },
    "alpaca-account-info": {
      "main": [[{"node": "merge-data", "type": "main", "index": 0}]]
    },
    "alpaca-get-positions": {
      "main": [[{"node": "merge-data", "type": "main", "index": 1}]]
    },
    "alpaca-get-quotes": {
      "main": [[{"node": "merge-data", "type": "main", "index": 2}]]
    },
    "alpaca-get-bars": {
      "main": [[{"node": "calc-indicators", "type": "main", "index": 0}]]
    },
    "alpaca-market-clock": {
      "main": [[{"node": "merge-data", "type": "main", "index": 3}]]
    },
    "calc-indicators": {
      "main": [[{"node": "merge-data", "type": "main", "index": 4}]]
    },
    "merge-data": {
      "main": [[{"node": "calc-risk", "type": "main", "index": 0}]]
    },
    "calc-risk": {
      "main": [[{"node": "llm-signal-generation", "type": "main", "index": 0}]]
    },
    "llm-signal-generation": {
      "main": [[{"node": "validate-signals", "type": "main", "index": 0}]]
    },
    "validate-signals": {
      "main": [[{"node": "loop-orders", "type": "main", "index": 0}]]
    },
    "loop-orders": {
      "main": [[{"node": "execute-order", "type": "main", "index": 0}]]
    },
    "execute-order": {
      "main": [[
        {"node": "handle-order-result", "type": "main", "index": 0},
        {"node": "db-store-trades", "type": "main", "index": 0}
      ]]
    },
    "handle-order-result": {
      "main": [[{"node": "notify-discord", "type": "main", "index": 0}]]
    },
    "db-store-trades": {
      "main": []
    },
    "db-store-signals": {
      "main": []
    },
    "notify-discord": {
      "main": []
    }
  },
  "settings": {"executionOrder": "v1"},
  "tags": [{"name": "stocks"}, {"name": "trading"}, {"name": "alpaca"}, {"name": "database"}, {"name": "discord"}]
}